package com.revshop.dao;

import com.revshop.model.Product;
import java.sql.*;
import com.revshop.util.DBConnection;
public class ProductDAO {
	public void addProduct(Product product) {

        String sql = "INSERT INTO products "
                   + "(seller_id, name, price, stock, category, description) "
                   + "VALUES (?, ?, ?, ?, ?, ?)";

        try (Connection con = DBConnection.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setInt(1, product.getSellerId());
            ps.setString(2, product.getName());
            ps.setDouble(3, product.getPrice());
            ps.setInt(4, product.getStock());
            ps.setString(5, product.getCategory());
            ps.setString(6, product.getDescription());

            ps.executeUpdate();
            System.out.println("Product added successfully!");

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    // VIEW SELLER PRODUCTS
    public void viewProductsBySeller(int sellerId) {

        String sql = "SELECT * FROM products WHERE seller_id = ?";

        try (Connection con = DBConnection.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setInt(1, sellerId);
            ResultSet rs = ps.executeQuery();

            System.out.println("ID | Name | Price | Stock | Category");
            while (rs.next()) {
                System.out.println(
                    rs.getInt("product_id") + " | " +
                    rs.getString("name") + " | " +
                    rs.getDouble("price") + " | " +
                    rs.getInt("stock") + " | " +
                    rs.getString("category")
                );
            }

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    // UPDATE PRODUCT
    public void updateProduct(Product product) {

        String sql = "UPDATE products SET name=?, price=?, stock=?, category=?, description=? "
                   + "WHERE product_id=? AND seller_id=?";

        try (Connection con = DBConnection.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setString(1, product.getName());
            ps.setDouble(2, product.getPrice());
            ps.setInt(3, product.getStock());
            ps.setString(4, product.getCategory());
            ps.setString(5, product.getDescription());
            ps.setInt(6, product.getProductId());
            ps.setInt(7, product.getSellerId());

            int rows = ps.executeUpdate();
            System.out.println(rows > 0 ? "Product updated!" : "Update failed!");

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

    // DELETE PRODUCT
    public void deleteProduct(int productId, int sellerId) {

        String sql = "DELETE FROM products WHERE product_id=? AND seller_id=?";

        try (Connection con = DBConnection.getConnection();
             PreparedStatement ps = con.prepareStatement(sql)) {

            ps.setInt(1, productId);
            ps.setInt(2, sellerId);

            int rows = ps.executeUpdate();
            System.out.println(rows > 0 ? "Product deleted!" : "Delete failed!");

        } catch (SQLException e) {
            e.printStackTrace();
        }
    }

	
}
