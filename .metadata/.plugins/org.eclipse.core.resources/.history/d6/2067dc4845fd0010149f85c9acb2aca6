package com.revshop.service;
import java.util.Scanner;
import java.sql.SQLException;
import com.revshop.dao.ProductDAO;
import com.revshop.model.Product;

public class SellerService {

    private ProductDAO productDAO = new ProductDAO();

    /* ================= ADD PRODUCT ================= */
    public void addProduct(
            String name,
            double mrp,
            double discountPrice,
            int stock,
            String category,
            String description,
            int sellerId
    ) throws SQLException {

        // Validation
        if (discountPrice > mrp) {
            System.out.println(" Discount price cannot be greater than MRP");
            return;
        }

        Product product = new Product();
        product.setName(name);
        product.setMrp(mrp);
        product.setDiscountPrice(discountPrice);
        product.setStock(stock);
        product.setCategory(category);
        product.setDescription(description);
        product.setSellerId(sellerId);

        // Call DAO method that accepts Product object
        productDAO.addProduct(product);
    }

    /* ================= VIEW SELLER PRODUCTS ================= */
    public void viewSellerProducts(int sellerId) throws SQLException {
        productDAO.getProductsBySeller(sellerId); // Fixed method name
    }

    /* ================= UPDATE PRODUCT ================= */
    public void updateProduct(
            int productId,
            int sellerId,
            String name,
            double mrp,
            double discountPrice,
            int stock,
            String category,
            String description
    ) throws SQLException {

        if (discountPrice > mrp) {
            System.out.println("Discount price cannot be greater than MRP");
            return;
        }

        Product product = new Product();
        product.setProductId(productId);
        product.setSellerId(sellerId);
        product.setName(name);
        product.setMrp(mrp);
        product.setDiscountPrice(discountPrice);
        product.setStock(stock);
        product.setCategory(category);
        product.setDescription(description);

        productDAO.updateProduct(product);
    }
    public void updatePrice(int sellerId) {
        Scanner sc = new Scanner(System.in);
        try {
            System.out.print("Enter Product ID to update price: ");
            int productId = Integer.parseInt(sc.nextLine());

            System.out.print("Enter New MRP: ");
            double newMrp = Double.parseDouble(sc.nextLine());

            System.out.print("Enter New Discount Price: ");
            double newDiscount = Double.parseDouble(sc.nextLine());

            // Validation
            if (newDiscount > newMrp) {
                System.out.println("Discount price cannot be greater than MRP");
                return;
            }

            // Get the product object
            Product product = new Product();
            product.setProductId(productId);
            product.setSellerId(sellerId);
            product.setMrp(newMrp);
            product.setDiscountPrice(newDiscount);

            // Only update price and discount in DAO
            productDAO.updateProductPrice(product);

            System.out.println("Price updated successfully!");

        } catch (NumberFormatException e) {
            System.out.println("Invalid input! Enter numeric values for MRP and Discount Price.");
        } catch (SQLException e) {
            System.out.println("Error updating price!");
            e.printStackTrace();
        }
    }

    

    /* ================= DELETE PRODUCT ================= */
    public void deleteProduct(int productId, int sellerId) throws SQLException {
        productDAO.deleteProduct(productId, sellerId); // Fixed method name
    }
}
